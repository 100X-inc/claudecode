---
allowed-tools: Bash(gh issue view:*),Bash(gh search:*),Bash(gh issue list:*),Bash(gh pr comment:*),Bash(gh pr diff:*),Bash(gh pr view:*),Bash(gh pr list:*),Bash(gh api:*),Bash(jq:*),WebFetch,WebSearch
description: 5つの観点（品質、パフォーマンス、テスト、ドキュメント、セキュリティ）からPRを包括的にレビューする
argument-hint: [owner/repo] [pr-number]
---

REPO: $1
PR NUMBER: $2

## ステップ 1: プロジェクトルールの読み込み

最初に、プロジェクトルートの CLAUDE.md ファイルを Read ツールで読み込み、プロジェクト固有のルール、開発環境、設計方針、コーディング規約を確認する。この情報は、後続のすべてのサブエージェントに共有される。

## ステップ 2: PR情報の取得

以下のコマンドでPRの詳細情報を取得する:

```bash
gh pr view $2 --repo $1 --json title,body,files,additions,deletions
gh pr diff $2 --repo $1
```

## ステップ 3: サブエージェントによる並列レビュー

以下の5つのサブエージェントを使用して、包括的なコードレビューを並列で実行する:

- **code-quality-reviewer** (コード品質レビュアー)
- **performance-reviewer** (パフォーマンスレビュアー)
- **test-coverage-reviewer** (テストカバレッジレビュアー)
- **documentation-reviewer** (ドキュメント正確性レビュアー)
- **security-code-reviewer** (セキュリティコードレビュアー)

**重要指示**:
- 各サブエージェントには、ステップ1で読み込んだ CLAUDE.md の内容を前提知識として提供する
- 各エージェント内で CLAUDE.md を再読み込みする必要はない
- PR番号とリポジトリ情報を各エージェントに渡す
- 各エージェントには**注目すべきフィードバックのみ**を提供するよう指示する

## ステップ 4: フィードバックの統合と投稿

1. 各サブエージェントからのフィードバックを収集する
2. 重複する指摘や軽微な問題は統合・除外する
3. 具体的な問題については **インラインコメント** で該当行に直接フィードバックを投稿する
4. 全般的な所見や称賛には **トップレベルコメント** を使用する
5. 以下の形式で最終判定を明示する:

```
## レビュー結果

### 総合判定: ✅ マージ可能 / ⚠️ 要修正 / ❌ 重大な問題あり

### 指摘事項サマリー
- 🔴 Critical: X件
- 🟠 Warning: X件
- 🟢 Info: X件

### 各観点の評価
| 観点 | 評価 | 主な指摘 |
|------|------|----------|
| コード品質 | ✅/⚠️/❌ | ... |
| パフォーマンス | ✅/⚠️/❌ | ... |
| テスト | ✅/⚠️/❌ | ... |
| ドキュメント | ✅/⚠️/❌ | ... |
| セキュリティ | ✅/⚠️/❌ | ... |
```
